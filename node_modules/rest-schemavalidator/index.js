function schemavalidator(ajvValidate) {
	return (req, res, next) => {
		if (!req.data) {
			res.statusCode = 203;
			res.setHeader('Content-Type', 'application/json');
			res.end(JSON.stringify('You must send data in JSON'));
		}
		const valid = ajvValidate(req.data);

		if (!valid) {
			const error = ajvValidate.errors;
			res.statusCode = 203;
			res.setHeader('Content-Type', 'application/json');
			res.end(JSON.stringify({ message: error[0].message }));
		}

		if (valid) {
			next();
		}
	};
}

module.exports = schemavalidator;
